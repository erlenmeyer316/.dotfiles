#!/usr/bin/env bash

{{ if eq .osid "linux-debian" }}

{{ template "shared_script_utils.bash" . }}
{{ template "debian_vscode.bash" . }}

# Apt
header "Checking for apt packages to remove"
{{ range $package := .debian.apt.remove.packages }}
    if dpkg -s "{{ $package }}" &> /dev/null; then
        sudo apt-get purge {{ $package }} -y
    fi
{{ end }}

sudo apt-get autoremove

# Flatpak
header "Checking for flatpak packages to remove"
{{ range $package := .debian.flatpak.remove.packages }}
    if flatpak list --app | grep -q "{{ $package }}"; then
        flatpak uninstall "{{ $package }}" -y
    fi
{{ end }}


# Manual
header "Checking for manual packages to remove"
{{ range $package := .debian.manual.remove.packages }}
    if [ "${manual}" -eq "vscode" ]; then
        uninstall_vscode
    fi
    if [ "${manual}" -eq "syncthing"]; then
        uninstall_syncthing
    fi
{{ end }}

_safeExit_

{{ end }}
