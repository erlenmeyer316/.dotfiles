#!/usr/bin/env bash

{{ if lookPath "pacman" }}

{{ template "shared_script_utils.bash" . }}

packages=(
    {{ range $package := .packages.pacman.base.packages }}
        "{{ $package }}"
    {{ end }}
    {{ if .personal_computer }}
        {{ range $package := .packages.pacman.personal_computer.packages }}
	    "{{ $package }}"
	{{ end }}
    {{ end}}
)

header "Installing packages with pacman"
sudo pacman -Sy 

for package in "${packages[@]}"; do
   if pacman -Qqe | grep "${package}" &> /dev/null; then
       info "Package ${package} is already installed"
       continue
   fi
   if pacman -Ss "${package}" | grep "${package}" &> /dev/null; then
      info "Installing ${package}"
      sudo pacman -S --noconfirm --quiet ${package}
   else
       warning "Package ${package} is not available in pacman"
   fi
done

success "pacman packages installed"
_safeExit_

{{ end }}
